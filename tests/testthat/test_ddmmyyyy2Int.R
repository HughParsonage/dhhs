test_that("ddmmyyyy2Int works", {
  expect_equal(ddmmyyyy2Int("04/03/2000"),
               as.integer(as.Date("04/03/2000", format = "%d/%m/%Y")))

  dates <- seq.Date(as.Date("2019-01-01"), as.Date("2022-12-31"), by = "1 day")
  dates_ddmmyyyy <- format(dates, "%d/%m/%Y")
  expect_identical(ddmmyyyy2Int(dates_ddmmyyyy),
                   as.integer(dates))
  expect_equal(ddmmyyyy2Int("foo", NA, "04/04/2021"),
               c(NA, NA, as.integer(as.Date("2021-04-04"))))

})

test_that("yyyymmdd", {
  x <- structure(c(18387, 18947, 19074, 18741, 19161, 18700), class = "Date")
  xf <- format(x, "%Y-%m-%d")
  expect_equal(yyyymmdd2Int(xf), as.integer(x))
})

test_that("yyyymmdd_HHMMSS_UTC works", {
  z2021 <- "2021-01-01 00:00:00 +00:00"
  expect_equal(yyyymmdd_HHMMSS_UTC(z2021),
               as.integer(as.POSIXct(z2021, tz = "UTC")))
  may2021 <- "2021-05-1200:00:00 +00:00"
  expect_equal(yyyymmdd_HHMMSS_UTC(may2021),
               as.integer(as.POSIXct(may2021, tz = "UTC")))
  YMDHMS <-
    seq(as.integer(as.POSIXct("2020-01-01 00:00:00", tz = "UTC")),
        as.integer(as.POSIXct("2023-01-01 00:00:00", tz = "UTC")) - 1L)

  rymd_hms <-
    c("2022-06-14 07:16:44", "2022-01-10 01:24:43", "2021-09-28 01:28:19",
      "2020-09-09 02:22:37", "2021-12-02 18:34:11", "2022-07-25 15:56:33",
      "2021-04-08 02:12:00", "2021-09-25 02:24:52", "2021-09-20 03:41:34",
      "2022-08-30 19:26:22", "2022-07-10 17:03:39", "2021-03-12 22:35:35",
      "2020-09-03 10:08:38", "2021-10-01 19:01:56", "2021-06-21 10:10:45",
      "2021-01-02 18:25:10", "2021-05-04 08:37:29", "2021-07-17 04:52:35",
      "2020-09-23 00:41:07", "2021-12-01 17:11:29", "2022-06-20 03:49:13",
      "2022-11-16 19:47:34", "2020-02-29 02:56:35", "2022-03-14 21:25:34",
      "2020-07-27 13:36:29", "2022-12-06 12:59:13", "2021-11-29 09:51:59",
      "2020-02-23 02:51:18", "2020-09-09 07:42:09", "2020-05-04 10:56:21")
  expect_equal(yyyymmdd_HHMMSS_UTC(rymd_hms),
               as.integer(as.POSIXct(rymd_hms, tz = "UTC")))

  # Unequal widths
  rymd_hms <-
    c("2022-06-14 07:16:44", "2022-01-10 01:24:43", "2021-09-28 01:28:19",
      "2020-09-09 02:22:37", "2021-12-02 18:34:11", "2022-07-25 15:56:33",
      "2021-04-08 02:12:00", "2021-09-25 02:24:52", "2021-09-20 03:41:34",
      "2022-08-30 19:26:22", "2022-07-10 17:03:39", "2021-03-12 22:35:35",
      "2020-09-03 10:08:38", "2021-10-01 19:01:56", "2021-06-21 10:10:45",
      "2021-01-02 18:25:10", "2021-05-04 08:37:29", "2021-07-17 04:52:35",
      "2020-09-23 00:41:07", "2021-12-01 17:11:29", "2022-06-20 03:49:13",
      "2022-11-16 19:47:34", "2020-02-29 02:56:35", "2022-03-14 21:25:34",
      "2020-07-27 13:36:29", "2022-12-06 12:59:13", "2021-11-29 09:51:59",
      "2020-02-23 02:51:18", "2020-09-09 07:42:09", "2020-05-04 10:56:21 +0000")
  expect_equal(yyyymmdd_HHMMSS_UTC(rymd_hms),
               as.integer(as.POSIXct(rymd_hms, tz = "UTC")))

  offsets <-
    c("2021-12-07 11:57:58 +1100", "2021-12-07 11:57:24 +1100", "2021-12-07 11:56:45 +1100",
      "2021-12-07 11:56:49 +1100", "2021-12-07 11:57:34 +1100", "2021-12-07 11:57:19 +1100")
  expect_equal(yyyymmdd_HHMMSS_UTC(offsets),
               as.integer(as.POSIXct(offsets, format = "%Y-%m-%d %H:%M:%S %z", tz = "UTC")))
  offsets <-
    c("2021-12-07 03:57:58 +0300", "2021-12-07 11:57:24 +1100", "2021-12-07 11:56:45 +1100",
      "2021-12-07 11:56:49 +1100", "2021-12-07 11:57:34 +1100", "2021-12-07 11:57:19 +1100")
  expect_equal(yyyymmdd_HHMMSS_UTC(offsets),
               as.integer(as.POSIXct(offsets, format = "%Y-%m-%d %H:%M:%S %z", tz = "UTC")))
  expect_equal(yyyymmdd_HHMMSS_UTC(offsets),
               as.integer(as.POSIXct(offsets, format = "%Y-%m-%d %H:%M:%S %z", tz = "UTC")))

})


